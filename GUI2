package gui;


import java.awt.Color;
import java.awt.EventQueue;
import javax.swing.JFrame;
import javax.swing.JList;
import javax.swing.JPanel;
import javax.swing.border.EmptyBorder;
import javax.swing.border.EtchedBorder;
import javax.swing.border.TitledBorder;


import donnee.ListEntreprise;

import java.awt.Font;
import javax.swing.DefaultListModel;
import javax.swing.JButton;
import java.awt.event.ActionListener;

import java.awt.event.ActionEvent;
import javax.swing.JTextField;
import javax.swing.SwingConstants;
import javax.swing.JScrollPane;
import javax.swing.JSeparator;

@SuppressWarnings("serial")
public class GUI2 extends JFrame {

	private JPanel contentPane;
	private JTextField txtAchat;
	private JTextField txtVente;
	static ListEntreprise singleton = ListEntreprise.getInstance();
	private DefaultListModel<String> listModel = new DefaultListModel<>();
	private DefaultListModel<String> listModel1 = new DefaultListModel<>();
	private DefaultListModel<String> listModel2 = new DefaultListModel<>();
	private DefaultListModel<String> listModel3 = new DefaultListModel<>();
	private DefaultListModel<String> listModel_vente_entreprise = new DefaultListModel<>();
	private DefaultListModel<String> listModel_vente_nbaction = new DefaultListModel<>();
	private JButton b1 = new JButton("Choisir ");
	private JButton b0 = new JButton("Valider Achat");
	double portefeuille=2000;
	private JTextField txtActionPossd;
	

	/**
	 * Launch the application.
	 */
	@SuppressWarnings("static-access")
	public static void main(String[] args) {
		
		singleton.testEntreprise();
		
		EventQueue.invokeLater(new Runnable() {
			public void run() {
				try {
					GUI2 frame = new GUI2();
					frame.setVisible(true);
				} catch (Exception e) {
					e.printStackTrace();
				}
			}
		});
	}

	/**
	 * Create the frame.
	 */
	@SuppressWarnings({ "rawtypes", "unchecked" })
	public GUI2() {
		setFont(new Font("Corbel", Font.PLAIN, 22));
		setTitle("Simulateur de Bourse");
		setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
		setBounds(100, 100, 1300, 650);
		contentPane = new JPanel();
		contentPane.setToolTipText("Valider choix");
		contentPane.setBorder(new EmptyBorder(5, 5, 5, 5));
		setContentPane(contentPane);
		contentPane.setLayout(null);
		
		JButton btnNewButton = new JButton("Revenir à l'interface précédente");
		btnNewButton.addActionListener(new ActionListener() {
			public void actionPerformed(ActionEvent e) {
				setVisible(false);
				GUI a =new GUI();
				a.setVisible(true);
			}
		});
		btnNewButton.setFont(new Font("Gadugi", Font.PLAIN, 21));
		btnNewButton.setBounds(0, 0, 1284, 31);
		getContentPane().add(btnNewButton);
		contentPane.add(btnNewButton);
		
		JList list = new JList(listModel);
		listModel.addElement("Total");
		listModel.addElement("Shell");
		listModel.addElement("BP");
		listModel.addElement("Esso");
		listModel.addElement("Edf");
		listModel.addElement("Apple");
		listModel.addElement("Logitech");
		listModel.addElement("Hp inc.");
		listModel.addElement("Dell");
		listModel.addElement("Wester Digital Corporation");
		listModel.addElement("Air France KLM");
		listModel.addElement("American Airlines");
		listModel.addElement("Delta Airlines");
		listModel.addElement("Lufthansa");
		listModel.addElement("Air Canada");
		listModel.addElement("Renault");
		listModel.addElement("Michelin");
		listModel.addElement("Ford Motor");
		listModel.addElement("Valeo");
		listModel.addElement("Peugeot PSA");
		
		listModel1.addElement("1");
		listModel1.addElement("2");
		listModel1.addElement("3");
		listModel1.addElement("4");
		listModel1.addElement("5");
		listModel1.addElement("6");
		listModel1.addElement("7");
		listModel1.addElement("8");
		listModel1.addElement("9");
		listModel1.addElement("10");
		
		listModel3.addElement("Vous commencez avec 2000 euros");
		
		list.setFont(new Font("Tahoma", Font.PLAIN, 11));
		list.setBorder(new TitledBorder(new EtchedBorder(EtchedBorder.LOWERED, new Color(255, 255, 255), new Color(160, 160, 160)), "Liste Entreprise", TitledBorder.CENTER, TitledBorder.TOP, null, Color.DARK_GRAY));
		list.setToolTipText("Liste Entreprise");
		list.setBounds(0, 42, 134, 509);
		list.add(b1);
		getContentPane().add(list);
		
		JButton b1 = new JButton("Choisir ");
		b1.setFont(new Font("Times New Roman", Font.PLAIN, 15));
		b1.setBounds(0, 552, 134, 59);
		getContentPane().add(b1);
		
		txtAchat = new JTextField();
		txtAchat.setFont(new Font("Trebuchet MS", Font.PLAIN, 18));
		txtAchat.setHorizontalAlignment(SwingConstants.CENTER);
		txtAchat.setText("Achat");
		txtAchat.setBounds(1006, 30, 278, 27);
		contentPane.add(txtAchat);
		txtAchat.setColumns(10);
		
		JList list_1 = new JList(listModel);
		JScrollPane p1=new JScrollPane(list_1);
		p1.setBorder(new TitledBorder(null, "Choix entreprise", TitledBorder.LEADING, TitledBorder.TOP, null, null));
		p1.setBounds(1006, 57, 142, 231);
		contentPane.add(p1);
		
		JList list_2 = new JList(listModel1);
		list_2.setBorder(new TitledBorder(null, "NbAction", TitledBorder.LEADING, TitledBorder.TOP, null, null));
		list_2.setBounds(1150, 57, 133, 231);
		contentPane.add(list_2);
		
		txtVente = new JTextField();
		txtVente.setFont(new Font("Tahoma", Font.PLAIN, 17));
		txtVente.setHorizontalAlignment(SwingConstants.CENTER);
		txtVente.setToolTipText("");
		txtVente.setText("Vente");
		txtVente.setBounds(1006, 320, 278, 31);
		contentPane.add(txtVente);
		txtVente.setColumns(10);
		
		JList list_3 = new JList(listModel_vente_entreprise);
		JScrollPane p3=new JScrollPane(list_3);
		p3.setBorder(new TitledBorder(null, "Choix entreprise", TitledBorder.LEADING, TitledBorder.TOP, null, null));
		p3.setBounds(1006, 352, 142, 231);
		contentPane.add(p3);
		
		JList list_4 = new JList(listModel1);
		list_4.setBorder(new TitledBorder(new EtchedBorder(EtchedBorder.LOWERED, new Color(255, 255, 255), new Color(160, 160, 160)), "NbAction", TitledBorder.LEADING, TitledBorder.TOP, null, new Color(0, 0, 0)));
		list_4.setBounds(1150, 352, 134, 231);
		contentPane.add(list_4);
		
		
		b0.setBounds(1006, 286, 278, 31);
		contentPane.add(b0);
		
		b0.addActionListener(new ActionListener() {
			@SuppressWarnings("deprecation")
			public void actionPerformed(ActionEvent e) {
				
				String entreprise;
				String nb_action;
				entreprise = list_1.getSelectedValue().toString();
				nb_action=list_2.getSelectedValue().toString();
				double valeur3 = Double.parseDouble(nb_action);
				@SuppressWarnings("static-access")
				double val_action= singleton.get_valeuraction_entreprise(entreprise);
				double prix_finale= valeur3*val_action;
				singleton.modifier_pourcentage_entreprise (valeur3, entreprise);
				
				
				if(prix_finale <= getPortefeuille()) {
					setPortefeuille(getPortefeuille()- prix_finale);
					String result=String.valueOf(val_action);
					
					listModel3.addElement("Entreprise :  " +list_1.getSelectedValue().toString()+ ", vous avez : " +list_2.getSelectedValue().toString()+ " action(s), il vous reste " + getPortefeuille()+ "euros");
					
					listModel_vente_nbaction.addElement(nb_action);
					listModel_vente_entreprise.addElement(entreprise);
				}
				else {
					String expression1="Vous n'avez pas assez d'argent malheuresement";
					listModel3.addElement(expression1);
				}
				
			}
		});
		
		
		JButton b4 = new JButton("Valider vente");
		b4.addActionListener(new ActionListener() {
			public void actionPerformed(ActionEvent e) {
				String entreprise;
				String nb_action;
				String nb_action1=listModel_vente_nbaction.firstElement() ;
				double valeur_nb_action1=Double.parseDouble(nb_action1);
				double nbaction_final=0;
				entreprise = list_3.getSelectedValue().toString();
				nb_action=list_4.getSelectedValue().toString();
				double valeur3 = Double.parseDouble(nb_action);
				
				double val_action= singleton.get_valeuraction_entreprise(entreprise);
				double prix_finale= valeur3*val_action;
				setPortefeuille(getPortefeuille()+prix_finale);
				listModel3.addElement("Entreprise :  " +list_3.getSelectedValue().toString()+ ", vous vendez : " +list_4.getSelectedValue().toString()+ " action(s), il vous reste " + getPortefeuille()+ "euros");
				for (int i=0; i<listModel_vente_entreprise.getSize();i++) {
					
					if(entreprise == listModel_vente_entreprise.elementAt(i)) {
						nbaction_final= valeur_nb_action1-valeur3;
						String result_nb_action = String.valueOf(nbaction_final);
						listModel_vente_nbaction.remove(i);
						listModel_vente_nbaction.add(i, result_nb_action);
						double valeur4 = Double.parseDouble(result_nb_action);
					if(valeur4 == 0) {
						listModel_vente_nbaction.remove(i);
						listModel_vente_entreprise.remove(i);
					}
					}
				}
				
				
				
				
			}
		});
		b4.setBounds(1006, 580, 278, 31);
		contentPane.add(b4);
		
		JPanel panel = new JPanel();
		panel.setBorder(new TitledBorder(null, "Graphique (A venir)", TitledBorder.LEADING, TitledBorder.TOP, null, null));
		panel.setBounds(136, 30, 869, 293);
		contentPane.add(panel);
		
		JButton b5 = new JButton("Play");
		b5.setBounds(136, 320, 412, 31);
		contentPane.add(b5);
		
		JButton b6 = new JButton("Pause");
		b6.setBounds(547, 320, 458, 31);
		contentPane.add(b6);
		
		JList list_7 = new JList(listModel3);
		JScrollPane p6=new JScrollPane(list_7);
		p6.setBorder(new TitledBorder(null, "Historique Achat/Vente", TitledBorder.LEADING, TitledBorder.TOP, null, null));
		p6.setBounds(557, 372, 448, 239);
		contentPane.add(p6);
		
		JSeparator separator = new JSeparator();
		separator.setBounds(538, 352, 20, 259);
		contentPane.add(separator);
		
		
		
		txtActionPossd = new JTextField();
		txtActionPossd.setHorizontalAlignment(SwingConstants.CENTER);
		txtActionPossd.setText("Action possédé par l'utilisateur");
		txtActionPossd.setBounds(136, 381, 427, 31);
		contentPane.add(txtActionPossd);
		txtActionPossd.setColumns(10);
		
		JList list_6 = new JList(listModel_vente_entreprise);
		JScrollPane p7=new JScrollPane(list_6);
		p7.setBorder(new TitledBorder(null, "Entreprise", TitledBorder.LEADING, TitledBorder.TOP, null, null));
		p7.setBounds(144, 411, 207, 200);
		contentPane.add(p7);
		
		JList list_8 = new JList(listModel_vente_nbaction);
		JScrollPane p8=new JScrollPane(list_8);
		p8.setBorder(new TitledBorder(null, "NbAction", TitledBorder.LEADING, TitledBorder.TOP, null, null));
		p8.setBounds(350, 411, 207, 200);
		contentPane.add(p8);
		
		
	}

	public double getPortefeuille() {
		return portefeuille;
	}

	public void setPortefeuille(double portefeuille) {
		this.portefeuille = portefeuille;
	}
}
